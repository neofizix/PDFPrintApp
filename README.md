
# PDF Printer App

## Overview

PDF Printer App is a Python-based application designed to handle PDF printing and saving in a silent manner, with built-in functionality for selecting a default printer and a folder to save PDFs. It provides a Flask-based API for easy interaction and includes a graphical user interface (GUI) for configuring PDF saving paths and printers.

## Features

- **Save PDFs**: Save base64-encoded PDF data to a specified folder.
- **Silent PDF Printing**: Print PDFs using the default printer without user interaction.
- **Printer Configuration**: Easily configure the default printer for the application.
- **Folder Selection**: Configure the folder where PDFs are stored.
- **System Tray Support**: Optionally supports a system tray icon (for use with GUI apps).

## Folder Structure

```bash
PDFPrinterApp/
│
├── pdfprinterapp/               # Main application package
│   ├── PDFPrinterApp.py         # Main logic for PDF saving, printing, and API
│   ├── PDFPrinterConfig.py      # Configuration management for printers and folders
│
├── config/                      # Configuration files
│   └── config.json              # Default configuration (auto-generated)
│
├── .gitignore                   # Specifies files to exclude from Git
├── README.md                    # Project documentation
├── requirements.txt             # Dependencies
├── 365PrintAppIcon.ico           # Custom app icon for system tray
└── service.log                  # Log file generated by the application
```

## Installation

1. Clone the repository:

   ```bash
   git clone https://github.com/yourusername/PDFPrinterApp.git
   ```

2. Navigate to the project directory:

   ```bash
   cd PDFPrinterApp
   ```

3. Create a virtual environment and activate it:

   ```bash
   python -m venv .venv
   source .venv/bin/activate  # On Windows: .venv\Scripts\activate
   ```

4. Install the dependencies:

   ```bash
   pip install -r requirements.txt
   ```

5. (Optional) Modify the `config.json` file in the `config` directory to set a custom default folder for saving PDFs or change the default printer.

## Usage

### Flask API

You can interact with the app via a Flask API. Here is the endpoint :

- **POST /api/printer/printraw**: Print a PDF silently using the default printer.
  - **Request**: JSON payload containing `pdf_data` (base64 string) and `doc_name` (PDF file name).
  - **Response**: Success message if the print job is successful.

Example request:

```bash
curl -X POST http://localhost:8072/api/printer/printraw -H "Content-Type: application/json" -d '{"pdf_data": "<base64_data>", "doc_name": "document.pdf"}'
```

### GUI for Printer and Folder Configuration

1. The app provides a simple graphical interface to configure the folder for saving PDFs and the default printer.
2. The GUI allows you to:
   - Choose a folder for saving PDFs.
   - Select a default printer from the list of available printers.

### Running the Application

To start the Flask API server:

```bash
python PDFPrinterApp.py
```

This will launch the API on `localhost:8072`. You can now send PDF data to be saved or printed using the provided endpoints.

### Logging

The application generates a `service.log` file to record all actions, including errors and file-saving paths.

## Configuration

The app generates a default configuration file at `config/config.json` with the following structure:

```json
{
    "pdf_folder": "C:/Temp",  # Default folder to save PDFs
    "default_printer": "YourDefaultPrinter"  # Default printer name
}
```

You can modify this file directly or use the GUI to configure your preferences.

## Requirements

- Python 3.x
- Dependencies listed in `requirements.txt`

### Dependencies

- `Flask`: For creating a REST API.
- `Flask-CORS`: To allow cross-origin requests.
- `pystray`: For system tray icon management.
- `Pillow`: To manage icons and images for the tray.
- `pywin32`: For Windows printing and system interaction.
- `tkinter`: For the GUI to manage printer and folder selection.

Install dependencies using:

```bash
pip install -r requirements.txt
```

## Development

If you want to contribute to this project, you can fork the repository and make your changes. Pull requests are welcome!
